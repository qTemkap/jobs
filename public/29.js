(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{"1nlY":function(t,a){t.exports="/images/profile-user.jpg?8cea90a6037de6e865135114a3522b91"},PXOu:function(t,a,e){"use strict";e.r(a);var i=e("Vt0J"),o=e("vDqi"),n=e.n(o),l={name:"AppUploader",components:{clipperFixed:i.a},props:{img:{type:String,default:null},request:{type:String,default:null},delete:{type:String,default:null},company:{type:Boolean,default:!1}},data:function(){return{image:this.img,uploadImage:null}},created:function(){},methods:{showModal:function(t){this.uploadImage=null,this.$modal.show(t)},hideModal:function(t){this.uploadImage=null,this.$modal.hide(t)},deletePhoto:function(){var t=this;n.a.delete(this.delete).then(function(a){200===a.status&&(t.hideModal("edit-photo"),t.company?t.$store.commit("SET_COMPANY_LOGO",null):document.querySelector(".header__auth-image").src="/images/auth.svg")}).catch(function(a){for(var e in a.response.data.errors)t.errors.add({field:e,msg:a.response.data.errors[e][0]})})},editPhotoSubmit:function(){var t=this;this.submitted=!0,this.$store.dispatch("addErrors",this.$validator.errors.items);var a=new FormData;a.append("_method","PUT"),null===this.uploadImage||this.company?null!==this.uploadImage&&this.company&&a.append("image",this.dataURItoBlob(this.uploadImage)):a.append("avatar",this.dataURItoBlob(this.uploadImage),"avatar.jpg"),this.$validator.validate().then(function(e){e&&n.a.post(t.request,a).then(function(a){200===a.status&&(t.company?(t.image=a.data.data,t.$store.commit("SET_COMPANY_LOGO",a.data.data)):(t.image=a.data.data.avatar,document.querySelector(".header__auth-image").src=a.data.data.avatar_thumb),t.uploadImage=null,t.hideModal("edit-photo"),t.saved=!0)}).catch(function(a){for(var e in a.response.data.errors)t.errors.add({field:e,msg:a.response.data.errors[e][0]})})})},getResult:function(){var t=this.$refs.clipper.clip();this.uploadImage=t.toDataURL("image/jpg",1)},upload:function(t){0!==t.target.files.length&&(this.uploadImage&&URL.revokeObjectURL(this.uploadImage),this.uploadImage=window.URL.createObjectURL(t.target.files[0]))},dataURItoBlob:function(t){if(null===t)return null;var a;a=t.split(",")[0].indexOf("base64")>=0?atob(t.split(",")[1]):unescape(t.split(",")[1]);for(var e=t.split(",")[0].split(":")[1].split(";")[0],i=new Uint8Array(a.length),o=0;o<a.length;o++)i[o]=a.charCodeAt(o);return new Blob([i],{type:e})},removeImage:function(){this.image=null,this.uploadImage=null,this.deletePhoto()}}},s=e("KHd+"),r=Object(s.a)(l,function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",[i("div",{staticClass:"profile__photo"},[i("h3",{staticClass:"profile__title"},[t.company?[t._v("\n                Логотип\n            ")]:[t._v("\n                Фотография\n            ")]],2),t._v(" "),i("div",{staticClass:"avatar-wrapper"},[null!==t.image?[i("img",{staticClass:"img-fluid img-profile",attrs:{src:t.image,alt:"profile"}})]:[t.company?[i("img",{staticClass:"img-fluid img-profile",attrs:{src:e("XsG0"),alt:"profile"}})]:[i("img",{staticClass:"img-fluid img-profile",attrs:{src:e("1nlY"),alt:"profile"}})]],t._v(" "),null!==t.image?i("button",{staticClass:"clear-photo",on:{click:function(a){return t.removeImage()}}},[i("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",width:"10px",height:"10px"}},[i("path",{attrs:{"fill-rule":"evenodd",fill:"rgb(0, 0, 0)",d:"M11.446,10.001 L20.009,18.567 L18.562,20.015 L9.998,11.450 L1.435,20.015 L-0.013,18.567 L8.550,10.001 L-0.013,1.436 L1.435,-0.013 L9.998,8.553 L18.562,-0.013 L20.009,1.436 L11.446,10.001 Z"}})])]):t._e()],2),t._v(" "),i("button",{staticClass:"btn btn-green btn-green-photo",on:{click:function(a){return t.showModal("edit-photo")}}},[t.company?[t._v("\n                 Загрузить логотип\n            ")]:[t._v("\n                 Загрузить фото\n            ")]],2)]),t._v(" "),i("modal",{staticClass:"modal modal-edit-photo",attrs:{name:"edit-photo"}},[i("div",{staticClass:"prev",on:{click:function(a){return t.hideModal("edit-photo")}}},[i("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 6 10",width:"6px",height:"10px"}},[i("path",{attrs:{"fill-rule":"evenodd",fill:"rgb(43, 83, 198)",d:"M5.995,9.312 L5.329,9.994 L1.117,5.681 L0.671,6.139 L0.005,5.457 L0.452,5.000 L0.005,4.542 L0.671,3.860 L1.118,4.318 L5.329,0.005 L5.995,0.686 L1.783,4.999 L5.995,9.312 Z"}})]),t._v("\n            Назад\n        ")]),t._v(" "),i("button",{staticClass:"close",on:{click:function(a){return t.hideModal("edit-photo")}}},[i("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",width:"20px",height:"20px"}},[i("path",{attrs:{"fill-rule":"evenodd",fill:"rgb(0, 0, 0)",d:"M11.446,10.001 L20.009,18.567 L18.562,20.015 L9.998,11.450 L1.435,20.015 L-0.013,18.567 L8.550,10.001 L-0.013,1.436 L1.435,-0.013 L9.998,8.553 L18.562,-0.013 L20.009,1.436 L11.446,10.001 Z"}})])]),t._v(" "),i("h2",{staticClass:"page-title"},[t.company?[t._v("\n                Ваш логотип\n            ")]:[t._v("\n                Ваша фотография\n            ")]],2),t._v(" "),i("div",{staticClass:"modal-content"},[i("form",{ref:"avatarForm",on:{keypress:function(a){if(!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter"))return null;a.preventDefault()},submit:function(a){return a.preventDefault(),t.editPhotoSubmit(a)}}},[t.uploadImage?i("div",[i("clipper-fixed",{ref:"clipper",staticClass:"my-clipper",attrs:{src:t.uploadImage}},[i("div",{staticClass:"placeholder",attrs:{slot:"placeholder"},slot:"placeholder"},[t._v("No image")])])],1):i("div",{staticClass:"image-download border"},[i("img",{staticClass:"img-fluid",attrs:{src:"/images/download-image.png"}}),t._v(" "),i("div",{staticClass:"image-download__text"},[t.company?[t._v("\n                            Пожалуйста, выберите свой логотип\n                        ")]:[t._v("\n                            Пожалуйста, выберите свою фотографию,\n                            лучше всего — лицо в анфас.\n                        ")]],2),t._v(" "),i("label",{staticClass:"btn download-btn"},[i("input",{attrs:{type:"file"},on:{change:function(a){return t.upload(a)}}}),t._v("\n                        Выбрать\n                    ")])]),t._v(" "),i("div",{staticClass:"btn-wrapper"},[i("button",{staticClass:"btn btn-green",attrs:{type:"submit"},on:{click:t.getResult}},[t._v("Сохранить")]),t._v(" "),i("span",{staticClass:"or"},[t._v("\n                        или\n                    ")]),t._v(" "),i("button",{staticClass:"link-default link-default__red",attrs:{type:"button"},on:{click:function(a){return t.hideModal("edit-photo")}}},[t._v("\n                        Отменить\n                    ")])])])])])],1)},[],!1,null,null,null);a.default=r.exports},XsG0:function(t,a){t.exports="/images/profile-company.jpg?42eca3510e491dc254194771dd7871af"}}]);